{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///home/user/agenko-nextjs/src/components/UtmLinkUpdater.tsx"],"sourcesContent":["// src/components/UtmLinkUpdater.tsx\n'use client';\n\nimport { useEffect } from 'react';\nimport { usePathname, useSearchParams } from 'next/navigation';\n\nconst SESSION_STORAGE_KEY = 'utm_params_session';\n\nexport function UtmLinkUpdater() {\n  const pathname = usePathname();\n  const searchParams = useSearchParams();\n\n  useEffect(() => {\n    console.log(`%c[UTM Updater] Effect triggered for path: ${pathname}`, 'color: blue; font-weight: bold;');\n\n    const currentQueryString = searchParams.toString();\n    console.log(`[UTM Updater] Current URL query string: \"${currentQueryString}\"`);\n\n    // 1. If the current URL has any 'utm_' parameter, save the entire query string.\n    if (currentQueryString.includes('utm_')) {\n      sessionStorage.setItem(SESSION_STORAGE_KEY, currentQueryString);\n      console.log(`%c[UTM Updater] Found UTMs! SAVED to session storage: \"${currentQueryString}\"`, 'color: green;');\n    } else {\n      console.log('[UTM Updater] No new UTMs found in URL.');\n    }\n\n    // 2. Get the stored UTM parameters.\n    const storedUtmParams = sessionStorage.getItem(SESSION_STORAGE_KEY);\n\n    // 3. If there are no stored params, do nothing.\n    if (!storedUtmParams) {\n      console.log('%c[UTM Updater] No stored UTMs found. Exiting.', 'color: red;');\n      return;\n    }\n    console.log(`[UTM Updater] Using stored UTMs: \"${storedUtmParams}\"`);\n\n    // 4. Update all <a> tags on the page.\n    const allLinks = document.getElementsByTagName('a');\n    console.log(`[UTM Updater] Found ${allLinks.length} <a> tags to process.`);\n\n    for (let i = 0; i < allLinks.length; i++) {\n      const link = allLinks[i];\n      const originalHref = link.getAttribute('href');\n\n      if (!originalHref || originalHref.startsWith('#') || originalHref.startsWith('mailto:') || originalHref.startsWith('tel:')) {\n        continue;\n      }\n      \n      // Use URL constructor for robust checking\n      try {\n        const url = new URL(link.href, window.location.origin);\n        if (url.search.includes(storedUtmParams)) {\n          continue; // Skip if params are already present\n        }\n        \n        // Append stored UTMs\n        const storedParams = new URLSearchParams(storedUtmParams);\n        storedParams.forEach((value, key) => {\n          url.searchParams.set(key, value);\n        });\n\n        console.log(`%c[UTM Updater] Updating link: ${originalHref} -> ${url.toString()}`, 'color: orange;');\n        link.href = url.toString();\n      } catch (e) {\n        console.error(`[UTM Updater] Could not parse URL for link: ${originalHref}`, e);\n      }\n    }\n    console.log('%c[UTM Updater] Finished processing links.', 'color: blue; font-weight: bold;');\n\n  }, [pathname, searchParams]);\n\n  return null;\n}"],"names":[],"mappings":"AAAA,oCAAoC;;;;;AAGpC;AACA;AAHA;;;AAKA,MAAM,sBAAsB;AAErB,SAAS;IACd,MAAM,WAAW,IAAA,iJAAW;IAC5B,MAAM,eAAe,IAAA,qJAAe;IAEpC,IAAA,kNAAS,EAAC;QACR,QAAQ,GAAG,CAAC,CAAC,2CAA2C,EAAE,UAAU,EAAE;QAEtE,MAAM,qBAAqB,aAAa,QAAQ;QAChD,QAAQ,GAAG,CAAC,CAAC,yCAAyC,EAAE,mBAAmB,CAAC,CAAC;QAE7E,gFAAgF;QAChF,IAAI,mBAAmB,QAAQ,CAAC,SAAS;YACvC,eAAe,OAAO,CAAC,qBAAqB;YAC5C,QAAQ,GAAG,CAAC,CAAC,uDAAuD,EAAE,mBAAmB,CAAC,CAAC,EAAE;QAC/F,OAAO;YACL,QAAQ,GAAG,CAAC;QACd;QAEA,oCAAoC;QACpC,MAAM,kBAAkB,eAAe,OAAO,CAAC;QAE/C,gDAAgD;QAChD,IAAI,CAAC,iBAAiB;YACpB,QAAQ,GAAG,CAAC,kDAAkD;YAC9D;QACF;QACA,QAAQ,GAAG,CAAC,CAAC,kCAAkC,EAAE,gBAAgB,CAAC,CAAC;QAEnE,sCAAsC;QACtC,MAAM,WAAW,SAAS,oBAAoB,CAAC;QAC/C,QAAQ,GAAG,CAAC,CAAC,oBAAoB,EAAE,SAAS,MAAM,CAAC,qBAAqB,CAAC;QAEzE,IAAK,IAAI,IAAI,GAAG,IAAI,SAAS,MAAM,EAAE,IAAK;YACxC,MAAM,OAAO,QAAQ,CAAC,EAAE;YACxB,MAAM,eAAe,KAAK,YAAY,CAAC;YAEvC,IAAI,CAAC,gBAAgB,aAAa,UAAU,CAAC,QAAQ,aAAa,UAAU,CAAC,cAAc,aAAa,UAAU,CAAC,SAAS;gBAC1H;YACF;YAEA,0CAA0C;YAC1C,IAAI;gBACF,MAAM,MAAM,IAAI,IAAI,KAAK,IAAI,EAAE,OAAO,QAAQ,CAAC,MAAM;gBACrD,IAAI,IAAI,MAAM,CAAC,QAAQ,CAAC,kBAAkB;oBACxC,UAAU,qCAAqC;gBACjD;gBAEA,qBAAqB;gBACrB,MAAM,eAAe,IAAI,gBAAgB;gBACzC,aAAa,OAAO,CAAC,CAAC,OAAO;oBAC3B,IAAI,YAAY,CAAC,GAAG,CAAC,KAAK;gBAC5B;gBAEA,QAAQ,GAAG,CAAC,CAAC,+BAA+B,EAAE,aAAa,IAAI,EAAE,IAAI,QAAQ,IAAI,EAAE;gBACnF,KAAK,IAAI,GAAG,IAAI,QAAQ;YAC1B,EAAE,OAAO,GAAG;gBACV,QAAQ,KAAK,CAAC,CAAC,4CAA4C,EAAE,cAAc,EAAE;YAC/E;QACF;QACA,QAAQ,GAAG,CAAC,8CAA8C;IAE5D,GAAG;QAAC;QAAU;KAAa;IAE3B,OAAO;AACT","debugId":null}}]
}